<template>
  <div class="container-coffe">
    <!-- Thanh t√¨m ki·∫øm -->
    <div class="search-bar">
      <input
        type="text"
        v-model="searchQuery"
        placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m..."
        @input="validateSearchQuery"
      />
      <button @click="applySearch">üîç</button>
    </div>

    <div class="content">
      <!-- B·ªô l·ªçc b√™n tr√°i -->
      <aside class="filter-section">
        <div class="filter-price">
          <h3>Kho·∫£ng gi√°</h3>
          <input
            type="number"
            v-model.number="priceFilter.min"
            placeholder="T·ª´"
            @input="validatePrice"
          />
          <input
            type="number"
            v-model.number="priceFilter.max"
            placeholder="ƒê·∫øn"
            @input="validatePrice"
          />
          <button @click="applyPriceFilter">√Åp d·ª•ng</button>
        </div>
      </aside>

      <!-- Danh s√°ch s·∫£n ph·∫©m -->
      <div class="product-grid">
        <!-- L·ªçc s·∫£n ph·∫©m theo c√°c b·ªô l·ªçc -->
        <div class="menu-item-coffes" v-for="product in filteredProducts" :key="product.id">
          <router-link
            :to="{ name: 'ProductDetail', params: { id: product.id } }"
            class="menu-item-link"
          >
            <img :src="product.image" :alt="product.name" class="menu-item-image" />
          </router-link>
          <div class="menu-item-info">
            <h3 class="menu-item-name">{{ product.name }}</h3>
            <p class="menu-item-price">{{ product.price }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { fetchProducts } from '../data/Product'; // H√†m l·∫•y d·ªØ li·ªáu t·ª´ API

export default {
  name: 'ComCoffee',

  data() {
    return {
      products: [], // L∆∞u danh s√°ch s·∫£n ph·∫©m t·ª´ API
      searchQuery: '', // T·ª´ kh√≥a t√¨m ki·∫øm
      priceFilter: { min: null, max: null }, // B·ªô l·ªçc gi√°
    };
  },

  computed: {
    // L·ªçc s·∫£n ph·∫©m c√≥ type l√† 'coffee' v√† √°p d·ª•ng b·ªô l·ªçc
    filteredProducts() {
      return this.products
        .filter(product => {
          // L·ªçc s·∫£n ph·∫©m theo t√™n t√¨m ki·∫øm
          if (this.searchQuery && !product.name.toLowerCase().includes(this.searchQuery.toLowerCase())) {
            return false;
          }

          // L·ªçc s·∫£n ph·∫©m theo kho·∫£ng gi√°
          if (this.priceFilter.min !== null && product.price < this.priceFilter.min) {
            return false;
          }
          if (this.priceFilter.max !== null && product.price > this.priceFilter.max) {
            return false;
          }

          // Ch·ªâ hi·ªÉn th·ªã s·∫£n ph·∫©m c√≥ type l√† 'coffee'
          return product.type.toLowerCase() === 'coffe';
        });
    },
  },

  mounted() {
    // G·ªçi API khi component ƒë∆∞·ª£c mount
    this.fetchData();
  },

  methods: {
    async fetchData() {
      try {
        const fetchedProducts = await fetchProducts(); // L·∫•y d·ªØ li·ªáu t·ª´ API
        this.products = fetchedProducts.filter(item => item.type === 'coffe'); // G√°n v√†o danh s√°ch s·∫£n ph·∫©m
      } catch (error) {
        console.error('L·ªói khi l·∫•y d·ªØ li·ªáu s·∫£n ph·∫©m:', error);
      }
    },

    applySearch() {
      // C√≥ th·ªÉ √°p d·ª•ng th√™m c√°c x·ª≠ l√Ω t√¨m ki·∫øm t·∫°i ƒë√¢y
    },

    applyPriceFilter() {
      // Th·ª±c hi·ªán √°p d·ª•ng b·ªô l·ªçc gi√°
    },

    validatePrice(event) {
      // Ki·ªÉm tra v√† ch·ªâ cho ph√©p nh·∫≠p gi√° tr·ªã d∆∞∆°ng (kh√¥ng √¢m)
      if (event.target.value < 0) {
        event.target.value = 0;
      }
    },

    validateSearchQuery() {
      // Ki·ªÉm tra ch·ªâ cho ph√©p nh·∫≠p k√Ω t·ª± ch·ªØ v√† s·ªë
      this.searchQuery = this.searchQuery.replace(/[^a-zA-Z0-9 ]/g, '');
    },
  },
};
</script>


<style scoped>
.title {
  color: #8b4513; /* M√†u n√¢u cho th·∫ª h1 */
}

.title-description {
  color: #8b4513; /* M√†u n√¢u cho th·∫ª p */
}

.container-coffe {
  margin-top: 100px;
}

.product-grid {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
}

.product-grid > * {
  flex: 0 0 calc(25% - 10px); /* 4 items per row */
  margin: 5px;
}

@media (max-width: 768px) {
  .product-grid > * {
    flex: 0 0 calc(50% - 10px); /* 2 items per row */
  }
}

@media (max-width: 480px) {
  .product-grid > * {
    flex: 0 0 calc(100% - 10px); /* 1 item per row */
  }
}

.container-coffe {
  padding-top: 20px;
  background-color: #fff;
}
.menu-item-coffes {
  position: relative;
  width: 200px;
  padding: 0;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  margin: 10px auto;
  background-color: #fff;
  overflow: hidden;
  transition: transform 0.3s ease;
}

.menu-item-coffes:hover {
  transform: scale(1.05);
}

.menu-item-link {
  display: block;
  text-decoration: none;
  color: inherit;
  border: 3px solid #b6832c; /* Th√™m vi·ªÅn v·ªõi m√†u #b6832c */
}

.menu-item-image {
  width: 150px;
  height: 150px;
  object-fit: cover;
}

.new-badge {
  position: absolute;
  top: 10px;
  left: 10px;
  background-color: orange;
  color: #fff;
  padding: 5px 10px;
  font-size: 12px;
  font-weight: bold;
  border-radius: 5px;
}

.menu-item-info {
  padding: 10px;
  text-align: center;
  background-color: #fff;
  border-top: 1px solid #eee;
  border: 3px solid #b6832c; /* Th√™m vi·ªÅn v·ªõi m√†u #b6832c */
}

.menu-item-name {
  font-size: 16px;
  font-weight: bold;
  margin: 0;
  color: #333;
}

.menu-item-price {
  font-size: 14px;
  color: #888;
  margin: 5px 0;
}
</style>
